<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>PropertyValueUtils.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Gradoop Common</a> &gt; <a href="index.source.html" class="el_package">org.gradoop.common.model.impl.properties</a> &gt; <span class="el_source">PropertyValueUtils.java</span></div><h1>PropertyValueUtils.java</h1><pre class="source lang-java linenums">/*
 * Copyright Â© 2014 - 2019 Leipzig University (Database Research Group)
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.gradoop.common.model.impl.properties;

import org.gradoop.common.exceptions.UnsupportedTypeException;

import java.math.BigDecimal;
import java.util.Arrays;

import static com.google.common.base.Preconditions.checkNotNull;

/**
 * Utilities for operations on multiple property values.
 */
<span class="nc" id="L28">public class PropertyValueUtils {</span>

  /**
   * Boolean utilities.
   */
<span class="nc" id="L33">  public static class Boolean {</span>

    /**
     * Logical or of two boolean properties.
     *
     * @param a first value
     * @param b second value
     * @return a OR b
     */
    public static PropertyValue or(PropertyValue a, PropertyValue b) {
<span class="fc" id="L43">      checkNotNull(a, b);</span>
<span class="fc" id="L44">      checkBoolean(a);</span>
<span class="fc" id="L45">      checkBoolean(b);</span>

<span class="fc bfc" id="L47" title="All 4 branches covered.">      a.setBoolean(a.getBoolean() || b.getBoolean());</span>

<span class="fc" id="L49">      return a;</span>
    }

    /**
     * Checks if a property value is boolean.
     *
     * @param value property value
     */
    private static void checkBoolean(PropertyValue value) {
<span class="pc bpc" id="L58" title="1 of 2 branches missed.">      if (!value.isBoolean()) {</span>
<span class="nc" id="L59">        throw new UnsupportedTypeException(value.getObject().getClass());</span>
      }
<span class="fc" id="L61">    }</span>
  }

  /**
   * Numeric utilities.
   */
<span class="nc" id="L67">  public static class Numeric {</span>

    /**
     * Short type.
     */
    private static final int SHORT = 0;
    /**
     * Integer type.
     */
    private static final int INT = 1;
    /**
     * Long type.
     */
    private static final int LONG = 2;
    /**
     * Float type.
     */
    private static final int FLOAT = 3;
    /**
     * Double type.
     */
    private static final int DOUBLE = 4;
    /**
     * Big decimal type.
     */
    private static final int BIG_DECIMAL = 5;

    /**
     * Adds two numerical property values.
     *
     * @param aValue first value
     * @param bValue second value
     *
     * @return first value + second value
     */
    public static PropertyValue add(
      PropertyValue aValue, PropertyValue bValue) {

<span class="fc" id="L105">      int aType = checkNumericalAndGetType(aValue);</span>
<span class="fc" id="L106">      int bType = checkNumericalAndGetType(bValue);</span>

<span class="fc bfc" id="L108" title="All 2 branches covered.">      boolean sameType = aType == bType;</span>

<span class="fc" id="L110">      int returnType = maxType(aType, bType);</span>

<span class="fc bfc" id="L112" title="All 2 branches covered.">      if (returnType == INT)  {</span>

<span class="fc bfc" id="L114" title="All 2 branches covered.">        int a = aType == INT ? aValue.getInt() : aValue.getShort();</span>
<span class="fc bfc" id="L115" title="All 2 branches covered.">        int b = bType == INT ? bValue.getInt() : bValue.getShort();</span>

<span class="fc" id="L117">        aValue.setInt(a + b);</span>

<span class="fc bfc" id="L119" title="All 2 branches covered.">      } else if (returnType == FLOAT)  {</span>

        float a;
        float b;

<span class="fc bfc" id="L124" title="All 2 branches covered.">        if (sameType) {</span>
<span class="fc" id="L125">          a = aValue.getFloat();</span>
<span class="fc" id="L126">          b = bValue.getFloat();</span>
        } else {
<span class="fc bfc" id="L128" title="All 2 branches covered.">          a = aType == FLOAT ? aValue.getFloat() : floatValue(aValue, aType);</span>
<span class="fc bfc" id="L129" title="All 2 branches covered.">          b = bType == FLOAT ? bValue.getFloat() : floatValue(bValue, bType);</span>
        }

<span class="fc" id="L132">        aValue.setFloat(a + b);</span>

<span class="fc bfc" id="L134" title="All 2 branches covered.">      } else if (returnType == LONG)  {</span>

        long a;
        long b;

<span class="fc bfc" id="L139" title="All 2 branches covered.">        if (sameType) {</span>
<span class="fc" id="L140">          a = aValue.getLong();</span>
<span class="fc" id="L141">          b = bValue.getLong();</span>
        } else {
<span class="fc bfc" id="L143" title="All 2 branches covered.">          a = aType == LONG ? aValue.getLong() : longValue(aValue, aType);</span>
<span class="fc bfc" id="L144" title="All 2 branches covered.">          b = bType == LONG ? bValue.getLong() : longValue(bValue, bType);</span>
        }

<span class="fc" id="L147">        aValue.setLong(a + b);</span>

<span class="fc bfc" id="L149" title="All 2 branches covered.">      } else if (returnType == DOUBLE)  {</span>

        double a;
        double b;

<span class="fc bfc" id="L154" title="All 2 branches covered.">        if (sameType) {</span>
<span class="fc" id="L155">          a = aValue.getDouble();</span>
<span class="fc" id="L156">          b = bValue.getDouble();</span>
        } else {
<span class="fc bfc" id="L158" title="All 2 branches covered.">          a = aType == DOUBLE ? aValue.getDouble() : doubleValue(aValue, aType);</span>
<span class="fc bfc" id="L159" title="All 2 branches covered.">          b = bType == DOUBLE ? bValue.getDouble() : doubleValue(bValue, bType);</span>
        }

<span class="fc" id="L162">        aValue.setDouble(a + b);</span>

<span class="fc" id="L164">      } else {</span>

        BigDecimal a;
        BigDecimal b;

<span class="fc bfc" id="L169" title="All 2 branches covered.">        if (sameType) {</span>
<span class="fc" id="L170">          a = aValue.getBigDecimal();</span>
<span class="fc" id="L171">          b = bValue.getBigDecimal();</span>
        } else {
<span class="fc bfc" id="L173" title="All 2 branches covered.">          a = aType == BIG_DECIMAL ?</span>
<span class="fc" id="L174">            aValue.getBigDecimal() : bigDecimalValue(aValue, aType);</span>
<span class="fc bfc" id="L175" title="All 2 branches covered.">          b = bType == BIG_DECIMAL ?</span>
<span class="fc" id="L176">            bValue.getBigDecimal() : bigDecimalValue(bValue, bType);</span>
        }

<span class="fc" id="L179">        aValue.setBigDecimal(a.add(b));</span>
      }

<span class="fc" id="L182">      return aValue;</span>
    }

    /**
     * Returns the maximum of two types, at least Integer.
     *
     * @param aType first type
     * @param bType second type
     *
     * @return larger compatible type
     */
    private static int maxType(int aType, int bType) {
<span class="fc" id="L194">      return Math.max(Math.max(aType, bType), INT);</span>
    }

    /**
     * Multiplies two numerical property values.
     *
     * @param aValue first value
     * @param bValue second value
     *
     * @return first value * second value
     */
    public static PropertyValue multiply(
      PropertyValue aValue, PropertyValue bValue) {

<span class="fc" id="L208">      int aType = checkNumericalAndGetType(aValue);</span>
<span class="fc" id="L209">      int bType = checkNumericalAndGetType(bValue);</span>

<span class="fc bfc" id="L211" title="All 2 branches covered.">      boolean sameType = aType == bType;</span>

<span class="fc" id="L213">      int returnType = maxType(aType, bType);</span>

<span class="fc bfc" id="L215" title="All 2 branches covered.">      if (returnType == INT)  {</span>

<span class="fc bfc" id="L217" title="All 2 branches covered.">        int a = aType == INT ? aValue.getInt() : aValue.getShort();</span>
<span class="fc bfc" id="L218" title="All 2 branches covered.">        int b = bType == INT ? bValue.getInt() : bValue.getShort();</span>

<span class="fc" id="L220">        aValue.setInt(a * b);</span>

<span class="fc bfc" id="L222" title="All 2 branches covered.">      } else if (returnType == FLOAT)  {</span>

        float a;
        float b;

<span class="fc bfc" id="L227" title="All 2 branches covered.">        if (sameType) {</span>
<span class="fc" id="L228">          a = aValue.getFloat();</span>
<span class="fc" id="L229">          b = bValue.getFloat();</span>
        } else {
<span class="fc bfc" id="L231" title="All 2 branches covered.">          a = aType == FLOAT ? aValue.getFloat() : floatValue(aValue, aType);</span>
<span class="fc bfc" id="L232" title="All 2 branches covered.">          b = bType == FLOAT ? bValue.getFloat() : floatValue(bValue, bType);</span>
        }

<span class="fc" id="L235">        aValue.setFloat(a * b);</span>

<span class="fc bfc" id="L237" title="All 2 branches covered.">      } else if (returnType == LONG)  {</span>

        long a;
        long b;

<span class="fc bfc" id="L242" title="All 2 branches covered.">        if (sameType) {</span>
<span class="fc" id="L243">          a = aValue.getLong();</span>
<span class="fc" id="L244">          b = bValue.getLong();</span>
        } else {
<span class="fc bfc" id="L246" title="All 2 branches covered.">          a = aType == LONG ? aValue.getLong() : longValue(aValue, aType);</span>
<span class="fc bfc" id="L247" title="All 2 branches covered.">          b = bType == LONG ? bValue.getLong() : longValue(bValue, bType);</span>
        }

<span class="fc" id="L250">        aValue.setLong(a * b);</span>

<span class="fc bfc" id="L252" title="All 2 branches covered.">      } else if (returnType == DOUBLE)  {</span>

        double a;
        double b;

<span class="fc bfc" id="L257" title="All 2 branches covered.">        if (sameType) {</span>
<span class="fc" id="L258">          a = aValue.getDouble();</span>
<span class="fc" id="L259">          b = bValue.getDouble();</span>
        } else {
<span class="fc bfc" id="L261" title="All 2 branches covered.">          a = aType == DOUBLE ? aValue.getDouble() : doubleValue(aValue, aType);</span>
<span class="fc bfc" id="L262" title="All 2 branches covered.">          b = bType == DOUBLE ? bValue.getDouble() : doubleValue(bValue, bType);</span>
        }

<span class="fc" id="L265">        aValue.setDouble(a * b);</span>

<span class="fc" id="L267">      } else {</span>

        BigDecimal a;
        BigDecimal b;

<span class="fc bfc" id="L272" title="All 2 branches covered.">        if (sameType) {</span>
<span class="fc" id="L273">          a = aValue.getBigDecimal();</span>
<span class="fc" id="L274">          b = bValue.getBigDecimal();</span>
        } else {
<span class="fc bfc" id="L276" title="All 2 branches covered.">          a = aType == BIG_DECIMAL ?</span>
<span class="fc" id="L277">            aValue.getBigDecimal() : bigDecimalValue(aValue, aType);</span>
<span class="fc bfc" id="L278" title="All 2 branches covered.">          b = bType == BIG_DECIMAL ?</span>
<span class="fc" id="L279">            bValue.getBigDecimal() : bigDecimalValue(bValue, bType);</span>
        }

<span class="fc" id="L282">        aValue.setBigDecimal(a.multiply(b));</span>
      }

<span class="fc" id="L285">      return aValue;</span>
    }

    /**
     * Compares two numerical property values
     *
     * @param aValue first value
     * @param bValue second value
     *
     * @return 0 if a equal to b, {@code &lt; 0} if {@code a &lt; b} and {@code &gt; 0} if {@code a &gt; b}
     */
    public static int compare(PropertyValue aValue, PropertyValue bValue) {

<span class="nc" id="L298">      int aType = checkNumericalAndGetType(aValue);</span>
<span class="nc" id="L299">      int bType = checkNumericalAndGetType(bValue);</span>

<span class="nc bnc" id="L301" title="All 2 branches missed.">      boolean sameType = aType == bType;</span>

<span class="nc" id="L303">      int maxType = Math.max(aType, bType);</span>

      int result;

<span class="nc bnc" id="L307" title="All 2 branches missed.">      if (maxType == SHORT) {</span>
<span class="nc" id="L308">        result = Short.compare(aValue.getShort(), bValue.getShort());</span>

<span class="nc bnc" id="L310" title="All 2 branches missed.">      } else if (maxType == INT)  {</span>
        int a;
        int b;

<span class="nc bnc" id="L314" title="All 2 branches missed.">        if (sameType) {</span>
<span class="nc" id="L315">          a = aValue.getInt();</span>
<span class="nc" id="L316">          b = bValue.getInt();</span>
        } else {
<span class="nc bnc" id="L318" title="All 2 branches missed.">          a = aType == INT ? aValue.getInt() : aValue.getShort();</span>
<span class="nc bnc" id="L319" title="All 2 branches missed.">          b = bType == INT ? bValue.getInt() : bValue.getShort();</span>
        }

<span class="nc" id="L322">        result = Integer.compare(a, b);</span>

<span class="nc bnc" id="L324" title="All 2 branches missed.">      } else if (maxType == FLOAT) {</span>
        float a;
        float b;

<span class="nc bnc" id="L328" title="All 2 branches missed.">        if (sameType) {</span>
<span class="nc" id="L329">          a = aValue.getFloat();</span>
<span class="nc" id="L330">          b = bValue.getFloat();</span>
        } else {
<span class="nc bnc" id="L332" title="All 2 branches missed.">          a = aType == FLOAT ? aValue.getFloat() : floatValue(aValue, aType);</span>
<span class="nc bnc" id="L333" title="All 2 branches missed.">          b = bType == FLOAT ? bValue.getFloat() : floatValue(bValue, bType);</span>
        }

<span class="nc" id="L336">        result = Float.compare(a, b);</span>

<span class="nc bnc" id="L338" title="All 2 branches missed.">      } else if (maxType == LONG) {</span>
        long a;
        long b;

<span class="nc bnc" id="L342" title="All 2 branches missed.">        if (sameType) {</span>
<span class="nc" id="L343">          a = aValue.getLong();</span>
<span class="nc" id="L344">          b = bValue.getLong();</span>
        } else {
<span class="nc bnc" id="L346" title="All 2 branches missed.">          a = aType == LONG ? aValue.getLong() : longValue(aValue, aType);</span>
<span class="nc bnc" id="L347" title="All 2 branches missed.">          b = bType == LONG ? bValue.getLong() : longValue(bValue, bType);</span>
        }

<span class="nc" id="L350">        result = Long.compare(a, b);</span>

<span class="nc bnc" id="L352" title="All 2 branches missed.">      } else if (maxType == DOUBLE) {</span>
        double a;
        double b;

<span class="nc bnc" id="L356" title="All 2 branches missed.">        if (sameType) {</span>
<span class="nc" id="L357">          a = aValue.getDouble();</span>
<span class="nc" id="L358">          b = bValue.getDouble();</span>
        } else {
<span class="nc bnc" id="L360" title="All 2 branches missed.">          a = aType == DOUBLE ? aValue.getDouble() : doubleValue(aValue, aType);</span>
<span class="nc bnc" id="L361" title="All 2 branches missed.">          b = bType == DOUBLE ? bValue.getDouble() : doubleValue(bValue, bType);</span>
        }

<span class="nc" id="L364">        result = Double.compare(a, b);</span>

<span class="nc" id="L366">      } else {</span>
        BigDecimal a;
        BigDecimal b;

<span class="nc bnc" id="L370" title="All 2 branches missed.">        if (sameType) {</span>
<span class="nc" id="L371">          a = aValue.getBigDecimal();</span>
<span class="nc" id="L372">          b = bValue.getBigDecimal();</span>
        } else {
<span class="nc bnc" id="L374" title="All 2 branches missed.">          a = aType == BIG_DECIMAL ? aValue.getBigDecimal() :</span>
<span class="nc" id="L375">                  bigDecimalValue(aValue, aType);</span>
<span class="nc bnc" id="L376" title="All 2 branches missed.">          b = bType == BIG_DECIMAL ? bValue.getBigDecimal() :</span>
<span class="nc" id="L377">                  bigDecimalValue(bValue, bType);</span>
        }

<span class="nc" id="L380">        result = a.compareTo(b);</span>
      }

<span class="nc" id="L383">      return result;</span>
    }

    /**
     * Compares two numerical property values and returns the smaller one.
     *
     * @param a first value
     * @param b second value
     *
     * @return smaller value
     */
    public static PropertyValue min(PropertyValue a, PropertyValue b) {
<span class="fc bfc" id="L395" title="All 2 branches covered.">      return isLessOrEqualThan(a, b) ? a : b;</span>
    }

    /**
     * Compares two numerical property values and returns the bigger one.
     *
     * @param a first value
     * @param b second value
     *
     * @return bigger value
     */
    public static PropertyValue max(PropertyValue a, PropertyValue b) {
<span class="fc bfc" id="L407" title="All 2 branches covered.">      return isLessOrEqualThan(a, b) ? b : a;</span>
    }

    /**
     * Compares two numerical property values and returns true,
     * if the first one is smaller.
     *
     * @param aValue first value
     * @param bValue second value
     *
     * @return a &lt; b
     */
    private static boolean isLessOrEqualThan(
      PropertyValue aValue, PropertyValue bValue) {

<span class="fc" id="L422">      int aType = checkNumericalAndGetType(aValue);</span>
<span class="fc" id="L423">      int bType = checkNumericalAndGetType(bValue);</span>

<span class="fc bfc" id="L425" title="All 2 branches covered.">      boolean sameType = aType == bType;</span>

<span class="fc" id="L427">      int returnType = maxType(aType, bType);</span>

      boolean aIsLessOrEqual;

<span class="fc bfc" id="L431" title="All 2 branches covered.">      if (returnType == INT)  {</span>

<span class="fc bfc" id="L433" title="All 2 branches covered.">        int a = aType == INT ? aValue.getInt() : aValue.getShort();</span>
<span class="fc bfc" id="L434" title="All 2 branches covered.">        int b = bType == INT ? bValue.getInt() : bValue.getShort();</span>

<span class="fc bfc" id="L436" title="All 2 branches covered.">        aIsLessOrEqual = a &lt;= b;</span>

<span class="fc bfc" id="L438" title="All 2 branches covered.">      } else if (returnType == FLOAT) {</span>

        float a;
        float b;

<span class="fc bfc" id="L443" title="All 2 branches covered.">        if (sameType) {</span>
<span class="fc" id="L444">          a = aValue.getFloat();</span>
<span class="fc" id="L445">          b = bValue.getFloat();</span>
        } else {
<span class="fc bfc" id="L447" title="All 2 branches covered.">          a = aType == FLOAT ? aValue.getFloat() : floatValue(aValue, aType);</span>
<span class="fc bfc" id="L448" title="All 2 branches covered.">          b = bType == FLOAT ? bValue.getFloat() : floatValue(bValue, bType);</span>
        }

<span class="fc bfc" id="L451" title="All 2 branches covered.">        aIsLessOrEqual = a &lt;= b;</span>

<span class="fc bfc" id="L453" title="All 2 branches covered.">      } else if (returnType == LONG) {</span>

        long a;
        long b;

<span class="fc bfc" id="L458" title="All 2 branches covered.">        if (sameType) {</span>
<span class="fc" id="L459">          a = aValue.getLong();</span>
<span class="fc" id="L460">          b = bValue.getLong();</span>
        } else {
<span class="fc bfc" id="L462" title="All 2 branches covered.">          a = aType == LONG ? aValue.getLong() : longValue(aValue, aType);</span>
<span class="fc bfc" id="L463" title="All 2 branches covered.">          b = bType == LONG ? bValue.getLong() : longValue(bValue, bType);</span>
        }

<span class="fc bfc" id="L466" title="All 2 branches covered.">        aIsLessOrEqual = a &lt;= b;</span>

<span class="fc bfc" id="L468" title="All 2 branches covered.">      } else if (returnType == DOUBLE) {</span>

        double a;
        double b;

<span class="fc bfc" id="L473" title="All 2 branches covered.">        if (sameType) {</span>
<span class="fc" id="L474">          a = aValue.getDouble();</span>
<span class="fc" id="L475">          b = bValue.getDouble();</span>
        } else {
<span class="fc bfc" id="L477" title="All 2 branches covered.">          a = aType == DOUBLE ? aValue.getDouble() : doubleValue(aValue, aType);</span>
<span class="fc bfc" id="L478" title="All 2 branches covered.">          b = bType == DOUBLE ? bValue.getDouble() : doubleValue(bValue, bType);</span>
        }

<span class="fc bfc" id="L481" title="All 2 branches covered.">        aIsLessOrEqual = a &lt;= b;</span>

<span class="fc" id="L483">      } else {</span>

        BigDecimal a;
        BigDecimal b;

<span class="fc bfc" id="L488" title="All 2 branches covered.">        if (sameType) {</span>
<span class="fc" id="L489">          a = aValue.getBigDecimal();</span>
<span class="fc" id="L490">          b = bValue.getBigDecimal();</span>
        } else {
<span class="fc bfc" id="L492" title="All 2 branches covered.">          a = aType == BIG_DECIMAL ? aValue.getBigDecimal() :</span>
<span class="fc" id="L493">            bigDecimalValue(aValue, aType);</span>
<span class="fc bfc" id="L494" title="All 2 branches covered.">          b = bType == BIG_DECIMAL ? bValue.getBigDecimal() :</span>
<span class="fc" id="L495">            bigDecimalValue(bValue, bType);</span>
        }

<span class="fc bfc" id="L498" title="All 2 branches covered.">        aIsLessOrEqual = a.compareTo(b) &lt;= 0;</span>
      }

<span class="fc" id="L501">      return aIsLessOrEqual;</span>
    }

    /**
     * Checks a property value for numerical type and returns its type.
     *
     * @param value property value
     *
     * @return numerical type
     */
    private static int checkNumericalAndGetType(PropertyValue value) {
<span class="fc" id="L512">      checkNotNull(value);</span>

      int type;

<span class="fc bfc" id="L516" title="All 2 branches covered.">      if (value.isShort()) {</span>
<span class="fc" id="L517">        type = SHORT;</span>
<span class="fc bfc" id="L518" title="All 2 branches covered.">      } else if (value.isInt()) {</span>
<span class="fc" id="L519">        type = INT;</span>
<span class="fc bfc" id="L520" title="All 2 branches covered.">      } else if (value.isLong()) {</span>
<span class="fc" id="L521">        type = LONG;</span>
<span class="fc bfc" id="L522" title="All 2 branches covered.">      } else if (value.isFloat()) {</span>
<span class="fc" id="L523">        type = FLOAT;</span>
<span class="fc bfc" id="L524" title="All 2 branches covered.">      } else if (value.isDouble()) {</span>
<span class="fc" id="L525">        type = DOUBLE;</span>
<span class="pc bpc" id="L526" title="1 of 2 branches missed.">      } else if (value.isBigDecimal()) {</span>
<span class="fc" id="L527">        type = BIG_DECIMAL;</span>
      } else {
<span class="nc" id="L529">        throw new UnsupportedTypeException(value.getObject().getClass());</span>
      }

<span class="fc" id="L532">      return type;</span>
    }

    /**
     * Converts a value of a lower domain numerical type to BigDecimal.
     *
     * @param value value
     * @param type type
     *
     * @return converted value
     */
    private static BigDecimal bigDecimalValue(PropertyValue value, int type) {
<span class="fc bfc" id="L544" title="All 5 branches covered.">      switch (type) {</span>
      case SHORT:
<span class="fc" id="L546">        return BigDecimal.valueOf(value.getShort());</span>
      case INT:
<span class="fc" id="L548">        return BigDecimal.valueOf(value.getInt());</span>
      case LONG:
<span class="fc" id="L550">        return BigDecimal.valueOf(value.getLong());</span>
      case FLOAT:
<span class="fc" id="L552">        return BigDecimal.valueOf(value.getFloat());</span>
      default:
<span class="fc" id="L554">        return BigDecimal.valueOf(value.getDouble());</span>
      }
    }

    /**
     * Converts a value of a lower domain numerical type to Double.
     *
     * @param value value
     * @param type type
     *
     * @return converted value
     */
    private static double doubleValue(PropertyValue value, int type) {
<span class="fc bfc" id="L567" title="All 4 branches covered.">      switch (type) {</span>
      case SHORT:
<span class="fc" id="L569">        return value.getShort();</span>
      case INT:
<span class="fc" id="L571">        return value.getInt();</span>
      case LONG:
<span class="fc" id="L573">        return value.getLong();</span>
      default:
<span class="fc" id="L575">        return value.getFloat();</span>
      }
    }

    /**
     * Converts a value of a lower domain numerical type to Long.
     *
     * @param value value
     * @param type type
     *
     * @return converted value
     */
    private static long longValue(PropertyValue value, int type) {
<span class="fc bfc" id="L588" title="All 2 branches covered.">      switch (type) {</span>
      case SHORT:
<span class="fc" id="L590">        return value.getShort();</span>
      default:
<span class="fc" id="L592">        return value.getInt();</span>
      }
    }

    /**
     * Converts a value of a lower domain numerical type to Float.
     *
     * @param value value
     * @param type type
     *
     * @return converted value
     */
    private static float floatValue(PropertyValue value, int type) {
<span class="fc bfc" id="L605" title="All 3 branches covered.">      switch (type) {</span>
      case SHORT:
<span class="fc" id="L607">        return value.getShort();</span>
      case INT:
<span class="fc" id="L609">        return value.getInt();</span>
      default:
<span class="fc" id="L611">        return value.getLong();</span>
      }
    }
  }

  /**
   * Byte utilities.
   */
<span class="nc" id="L619">  public static class BytesUtils {</span>

    /**
     * Get the raw byte representation of a {@link PropertyValue} instance without the type byte as prefix.
     *
     * @param value the {@link PropertyValue} to extract the bytes
     * @return a byte array containing the value without type information
     */
    public static byte[] getRawBytesWithoutType(PropertyValue value) {
<span class="fc" id="L628">      return Arrays.copyOfRange(value.getRawBytes(), 1, value.getRawBytes().length);</span>
    }

    /**
     * Get the type byte of a {@link PropertyValue} instance. It's the first one of the
     * raw representation of a PropertyValue.
     *
     * @param value the {@link PropertyValue} to extract the type byte
     * @return the type byte as array
     */
    public static byte[] getTypeByte(PropertyValue value) {
<span class="fc" id="L639">      byte[] typeByte = new byte[1];</span>
<span class="fc" id="L640">      typeByte[0] = value.getRawBytes()[0];</span>
<span class="fc" id="L641">      return typeByte;</span>
    }

    /**
     * Creates a {@link PropertyValue} instance by concatenating the byte representations
     * of the type and the value.
     *
     * @param typeByte a byte array containing only one byte representing the value type
     * @param valueBytes a byte array representing the property value
     * @return the resulting {@link PropertyValue}
     */
    public static PropertyValue createFromTypeValueBytes(byte[] typeByte, byte[] valueBytes) {
<span class="fc" id="L653">      byte[] validValue = new byte[valueBytes.length + 1];</span>
<span class="fc" id="L654">      validValue[0] = typeByte[0];</span>
<span class="fc" id="L655">      System.arraycopy(valueBytes, 0, validValue, 1, valueBytes.length);</span>
<span class="fc" id="L656">      return PropertyValue.fromRawBytes(validValue);</span>
    }
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.1.201803210924</span></div></body></html>